Setting up Kiosks for Windows 8 && 10 
-------------------------------------

Goals:
  * Set up and configure secure kiosk 
  * Kiosk should be running Google Chrome
  * Start page destination -> https://chassintranet.ucr.edu/saas2/advisor
  * User should not be able to exit the browser or do anything else on PC

Options:
  1. Group Policy && Scripts
  2. Assigned Access
  3. Shell Launcher

Notes:
  * You cannot configure Assigned Access and Shell Launcher on the same system.

Application Types:
  * Win32 - Classic Windows
  * UWP   - Universal Windows Platform (Windows Store apps)

=======================================

1. Group Policy && Scripts
--------------------------

Probably the most flexible option in terms of what can be done.
Browser application can be launched by custom scripts with either Command Prompt and PowerShell.
Group Policies can be configured similarly to our already existing help document for Windows 8

Steps:
  * Create a local user as a non admin account
  * Use MMC to configure a group policy object for the user

Microsoft Management Console:
  * add a Group Policy Object
  * set up restrictions for the user account
  * run script at user logon
      windows settings -> scripts -> logon -> add the script files

=======================================

2.1 Assigned Access (UWP)
-------------------

Requirements:
  Windows 10 Enterprise, Windows 10 Education, or Windows 10 Pro

Location:
  windows 8  : pc settings -> accounts -> other accounts -> set up account for assigned access
  windows 10 : settings -> accounts -> other people -> set up assigned access

Options:
  choose an account to use - non admin account
  choose an app to use     - must be a windows store app

Exit:
  windows 8  : press Windows key 5 times
  windows 10 : press Ctrl + Alt + Del 

Note:
  some apps might not show up in the list of choices.
  if that happens, use PowerShell for manual set up.
  
=======================================

2.2 PowerShell set up Assigned Access (UWP)
-------------------------------------

NAME
    Set-AssignedAccess

SYNTAX
    Set-AssignedAccess -AppName <String> -UserName <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
    Set-AssignedAccess -AppName <String> -UserSID <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
    Set-AssignedAccess -AppUserModelId <String> -UserName <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
    Set-AssignedAccess -AppUserModelId <String> -UserSID <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
DESCRIPTION
    The Set-AssignedAccess cmdlet configures the specified user account so that it can use only one Windows Store app. 
	The user cannot exit the app, sign out, or access any system settings.
	
Undo:
    To remove assigned access, using PowerShell, run the following cmdlet.
	Clear-AssignedAccess

Note:
    to use Set-AssignedAccess need to know 1. (UserName or UserSID), and 2. (AppName or AppUserModelId)
    1. to find a UserSID use PowerShell command "Get-WmiObject win32_useraccount"
    2. to find an AppUserModelId use the listAumids method from Microsoft documentation.
       (run the printAumids.ps1 script in the util folder, it prints a txt file with every Aumid)
	  
=======================================

3. Shell Launcher  (Win32)
-----------------

Requirements:
  Windows 10 Enterprise or Windows 10 Education

Restrictions:
  * Cannot use Eshell.exe as a custom shell 
  * Cannot use a Universal Windows app as a custom shell
  * Cannot use a custom shell to launch Universal Windows apps
  * Cannot use an application that launches a different process and exits as a custom shell

Enable: To make the setting available to the device and optionally apply the settings to the device.
  * Control Panel -> programs and features -> turn windows features on or off
  * WESL_UserSetting
  * DISM
  * Windows Configuration Designer
  (used control panel, could not get DISM script running)	
	
Configure: To customize the setting or sub-settings.
  * Assigned Access Configuration Service Provider (CSP)
  * Use the Shell Launcher WMI providers directly in a PowerShell script or application

Script: 
  * Start with the default template and modify to fit needs

Note: 
  * Shell Launcher is an optional component and is not turned on by default in Windows 10. 
    It must be turned on prior to configuring.
  * Changing the shell settings can alter the functionality of the operating system
  * If try running on non-Enterprise or non-Education then will load to a basically unusable black screen with no taskbar
 
=======================================

4. xxxx
-------

xxxx

=======================================

Conclusion
----------

Satisfactory:
  * Group Policy && Scripts is a complete solution, it allows a minimized Chrome window to be run and respawned.
    This requires much careful manual configuration. eg: many things must be restricted or hidden.

Possibly Satisfactory:  
  * Assigned Access is not practical for Chrome since it only works with UWP apps, and because Google Chrome a Win32 app, it cannot be used.
    However, Microsoft Edge can be used with Assigned Access if set through PowerShell.
    But, according to Microsoft documentation: 
      "Microsoft Edge and any third-party web browsers that can be set as a default browser have special permissions 
       beyond that of most Windows apps. Microsoft Edge is not currently supported for assigned access."

  * Shell Launcher would probably be practical if running on Enterprise or Education distributions of Windows.
    However, since running Windows 10 Pro, it does not correctly work so we cannot fully test solution.

Unsatisfactory:	
  * See error_log.txt
	
=======================================

