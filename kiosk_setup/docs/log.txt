Setting up a kiosk for Windows 8 && 10 
--------------------------------------

Options:
  0. Group Policy && Batch Files
  1. Assigned Access
  2. Shell Launcher

Notes:
  * You cannot configure Assigned Access and Shell Launcher on the same system.
  * Shell Launcher Requires Windows 10 Enterprise or Windows 10 Education to run.

Application Types:
  * Win32 - Classic Windows
  * UWP   - Universal Windows Platform (Windows Store apps)

=======================================

0. Group Policy && Batch Files
------------------------------

Configured similarly to the help document for windows 8

Microsoft Management Console:
  * add a Group Policy Object
  * set up restrictions for the user account
  * run kioskbootstrap.bat at user logon
      windows settings -> scripts -> logon -> add the batch files

=======================================

1.1 Assigned Access (UWP)
-------------------

Location:
  windows 8  : pc settings -> accounts -> other accounts -> set up account for assigned access
  windows 10 : settings -> accounts -> other people -> set up assigned access

Options:
  choose an account to use - non admin account
  choose an app to use     - must be a windows store app

Exit:
  windows 8  : press Windows key 5 times
  windows 10 : press Ctrl + Alt + Del 

note:
  some apps might not show up in the list of choices.
  if that happens, use PowerShell for manual set up.
  
=======================================

1.2 PowerShell set up Assigned Access (UWP)
-------------------------------------

NAME
    Set-AssignedAccess

SYNTAX
    Set-AssignedAccess -AppName <String> -UserName <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
    Set-AssignedAccess -AppName <String> -UserSID <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
    Set-AssignedAccess -AppUserModelId <String> -UserName <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
    Set-AssignedAccess -AppUserModelId <String> -UserSID <String> [-Confirm] [-WhatIf] [<CommonParameters>]
    
DESCRIPTION
    The Set-AssignedAccess cmdlet configures the specified user account so that it can use only one Windows Store app. 
	The user cannot exit the app, sign out, or access any system settings.
	
undo:
    To remove assigned access, using PowerShell, run the following cmdlet.
	Clear-AssignedAccess

note:
    to use Set-AssignedAccess need to know 1. (UserName or UserSID), and 2. (AppName or AppUserModelId)
	to find a UserSID run PowerShell command "Get-WmiObject win32_useraccount"
    to find an AppUserModelId use the listAumids method from Microsoft documentation.
    (run the printAumids.ps1 script in the util folder, it prints a txt file with every Aumid)
	
  
=======================================

2. Shell Launcher  (Win32)
-----------------

Requirements:
  Windows 10 Enterprise or Windows 10 Education.	

Shell Launcher is an optional component and is not turned on by default in Windows 10, It must be turned on prior to configuring.

cannot use Eshell.exe as a custom shell 
cannot use a Universal Windows app as a custom shell
cannot use a custom shell to launch Universal Windows apps
cannot use an application that launches a different process and exits as a custom shell

Enable: To make the setting available to the device and optionally apply the settings to the device.
  * Control Panel -> programs and features -> turn windows features on or off
  * WESL_UserSetting
  * DISM
  * Windows Configuration Designer
  (used control panel, could not get DISM script running)	
	
Configure: To customize the setting or sub-settings.
  * Assigned Access Configuration Service Provider (CSP)
  * Use the Shell Launcher WMI providers directly in a PowerShell script or application

Script: start with the template and modify to fit needs

be careful: 
  * changing the shell settings can break the functionality of the system
  * if try running on non-Enterprise or non-Education then will load to a basically unusable black screen with no taskbar
 
=======================================

3. Kiosk Browser App (FIXME)
--------------------

install "Kiosk Browser" app in the Windows Store

setup: ???
-> needs to be configured
-> configure Kiosk Browser through provisioning or MDM

attempt 1:

trying to use the Windows Configuration Designer, not successful yet

attempt 2:

since Kiosk Browser is UWP tried using PowerShell for Set-AssignedAccess with (UserName, AppUserModelId) && (UserSID, AppUserModelId)
however, failed with different errors on separate tries

Set-CimInstance : One or more parameter values passed to the method were invalid.
At C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\AssignedAccess\AssignedAccess.psm1:301 char:25
+ ... $instance | Set-CimInstance -Property @{AppUserModelId=$AppUserModelI ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (WEDL_AssignedAc...10-13324431...):CimInstance) [Set-CimInstance], CimException
    + FullyQualifiedErrorId : MI RESULT 4,Microsoft.Management.Infrastructure.CimCmdlets.SetCimInstanceCommand

	
New-CimInstance : One or more parameter values passed to the method were invalid.
At C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\AssignedAccess\AssignedAccess.psm1:310 char:13
+             New-CimInstance -ClassName WEDL_AssignedAccess -Property  ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (WEDL_AssignedAccess:CimInstance) [New-CimInstance], CimException
    + FullyQualifiedErrorId : MI RESULT 4,Microsoft.Management.Infrastructure.CimCmdlets.NewCimInstanceCommand
	
=======================================

4. Provisioning Package (FIXME)
-----------------------

install "Windows Configuration Designer" app in the Windows Store

setup: ???
-> unsuccessful with both Win32 && UWP
-> when trying to set up with a browser app gets the error message:
     "We found some validation errors. To find out what went wrong and see suggestions on how to fix it, click this icon:  "
 
=======================================

not done yet:
  * Kiosk Browser
  * Provisioning Package (UWP or Win32)
	
possibly unable to use:
  * Intune/other MDM service (UWP)
      - trial version or buy the licensing
      - might not be possible to activate Kiosk Mode on Windows 10 Pro using Microsoft Intune Standalone. 
	  
	  
	  
	  
	  
	  
	  
